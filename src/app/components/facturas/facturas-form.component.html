<div class="col-md-8">
    <ul class="alert alert-danger" *ngIf="errores?.length > 0">
        <li *ngFor="let error of errores">
            {{error}}
        </li>
    </ul>
    <button mat-flat-button color="primary" class="mb-3" [routerLink]="['/clientes']">
        <mat-icon>home</mat-icon>
    </button>
    <form>
        <div class="form-group" *ngIf="factura.cliente">
            <label for="cliente">Cliente</label>
            <input type="text" class="form-control" id="cliente" name="cliente"
                value="{{factura.cliente.nombre}} {{factura.cliente.apellido}}" disabled style="width: 55%;">
        </div>
        <div class="form-group">
            <label for="fechaEmision">Fecha Emisión</label>
            <input type="text" class="form-control" id="fechaEmision" name="fechaEmision"
                [(ngModel)]="factura.fechaEmision" style="width: 55%;">
        </div>
        <div class="form-group">
            <label for="producto">Producto</label>
            <div class="card">
                <div class="card-body">
                    <input type="text" class="form-control mb-3" placeholder="Búscar Producto..."
                        (keyup)="filtrarProductoPorNombre($event.target.value)" style="width: 55%;">
                    <mat-selection-list #productos
                        (selectionChange)="seleccionProducto(productos.selectedOptions.selected)" style="width: 55%;">
                        <mat-list-option *ngFor="let producto of productosFiltrados" [value]="producto">
                            {{producto.nombre}}
                        </mat-list-option>
                    </mat-selection-list>
                    <div class="alert alert-info" *ngIf="factura.items.length == 0" style="width: 55%;">No hay productos
                        aún.</div>
                    <table mat-table [dataSource]="factura.items" class="mat-elevation-z8 mt-4" style="width: 95%;"
                        *ngIf="factura.items.length > 0">
                        <!-- Columna Nombre -->
                        <ng-container matColumnDef="nombre">
                            <th mat-header-cell *matHeaderCellDef> Nombre </th>
                            <td mat-cell *matCellDef="let item"> {{item.producto.nombre}} </td>
                        </ng-container>
                        <!-- Columna Precio -->
                        <ng-container matColumnDef="precio">
                            <th mat-header-cell *matHeaderCellDef> Precio </th>
                            <td mat-cell *matCellDef="let item"> {{item.producto.precio}} </td>
                        </ng-container>
                        <!-- Columna Stock -->
                        <ng-container matColumnDef="stock">
                            <th mat-header-cell *matHeaderCellDef> Stock </th>
                            <td mat-cell *matCellDef="let item"> {{item.producto.stock}} </td>
                        </ng-container>
                        <!-- Columna Cantidad -->
                        <ng-container matColumnDef="cantidad">
                            <th mat-header-cell *matHeaderCellDef> Cantidad </th>
                            <td mat-cell *matCellDef="let item">
                                <input type="text" class="form-control" id="cantidad" name="cantidad"
                                    [(ngModel)]="item.cantidad" style="width: 50%;">
                            </td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="columnasMostradasItem"></tr>
                        <tr mat-row *matRowDef="let row; columns: columnasMostradasItem;"></tr>
                    </table>
                </div>
            </div>
        </div>
    </form>
    <button mat-flat-button color="accent" (click)='crear()' *ngIf="!factura.id else update">
        <mat-icon>check</mat-icon>
    </button>
    <ng-template #update>
        <button mat-flat-button color="accent" (click)='actualizar()'>
            <mat-icon>edit</mat-icon>
        </button>
    </ng-template>
</div>